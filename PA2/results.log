srun -N 1 --gres=gpu:1 ./benchmark 100
Time: 0.274523 ms

srun -N 1 --gres=gpu:1 ./benchmark 1000
Time: 15.435715 ms

srun -N 1 --gres=gpu:1 ./benchmark 2500
Time: 377.848763 ms

srun -N 1 --gres=gpu:1 ./benchmark 5000
Time: 2987.083891 ms

srun -N 1 --gres=gpu:1 ./benchmark 7500
Time: 10051.674201 ms

srun -N 1 --gres=gpu:1 ./benchmark 10000
Time: 22837.635265 ms

// Initial Implementation

srun -N 1 --gres=gpu:1 ./benchmark 100
Time: 0.103474 ms

srun -N 1 --gres=gpu:1 ./benchmark 1000
Time: 4.564546 ms

srun -N 1 --gres=gpu:1 ./benchmark 2500
Time: 64.727090 ms

srun -N 1 --gres=gpu:1 ./benchmark 5000
Time: 468.741194 ms

srun -N 1 --gres=gpu:1 ./benchmark 7500
Time: 1571.626846 ms

srun -N 1 --gres=gpu:1 ./benchmark 10000
Time: 3712.620091 ms

// Cancel ifs & unroll loops

srun -N 1 --gres=gpu:1 ./benchmark 100
Time: 0.132945 ms

srun -N 1 --gres=gpu:1 ./benchmark 1000
Time: 5.253858 ms

srun -N 1 --gres=gpu:1 ./benchmark 2500
Time: 60.113955 ms

srun -N 1 --gres=gpu:1 ./benchmark 5000
Time: 457.705743 ms

srun -N 1 --gres=gpu:1 ./benchmark 7500
Time: 1528.729603 ms

srun -N 1 --gres=gpu:1 ./benchmark 10000
Time: 3606.880943 ms

// No sync at stage 3

srun -N 1 --gres=gpu:1 ./benchmark 100
Time: 0.111749 ms

srun -N 1 --gres=gpu:1 ./benchmark 1000
Time: 3.197776 ms

srun -N 1 --gres=gpu:1 ./benchmark 2500
Time: 36.036043 ms

srun -N 1 --gres=gpu:1 ./benchmark 5000
Time: 241.380140 ms

srun -N 1 --gres=gpu:1 ./benchmark 7500
Time: 800.905326 ms

srun -N 1 --gres=gpu:1 ./benchmark 10000
Time: 1883.782554 ms

// No sync at stage 2

srun -N 1 --gres=gpu:1 ./benchmark 100
Time: 0.093594 ms

srun -N 1 --gres=gpu:1 ./benchmark 1000
Time: 2.941648 ms

srun -N 1 --gres=gpu:1 ./benchmark 2500
Time: 33.701591 ms

srun -N 1 --gres=gpu:1 ./benchmark 5000
Time: 238.342359 ms

srun -N 1 --gres=gpu:1 ./benchmark 7500
Time: 794.087688 ms

srun -N 1 --gres=gpu:1 ./benchmark 10000
Time: 1871.806711 ms

// No sync at stage 1

srun -N 1 --gres=gpu:1 ./benchmark 100
Time: 0.073830 ms

srun -N 1 --gres=gpu:1 ./benchmark 1000
Time: 2.722720 ms

srun -N 1 --gres=gpu:1 ./benchmark 2500
Time: 31.103638 ms

srun -N 1 --gres=gpu:1 ./benchmark 5000
Time: 237.876972 ms

srun -N 1 --gres=gpu:1 ./benchmark 7500
Time: 792.951495 ms

srun -N 1 --gres=gpu:1 ./benchmark 10000
Time: 1870.387725 ms

// Use register

srun -N 1 --gres=gpu:1 ./benchmark 100
Time: 0.064481 ms

srun -N 1 --gres=gpu:1 ./benchmark 1000
Time: 2.385421 ms

srun -N 1 --gres=gpu:1 ./benchmark 2500
Time: 30.124741 ms

srun -N 1 --gres=gpu:1 ./benchmark 5000
Time: 205.887355 ms

srun -N 1 --gres=gpu:1 ./benchmark 7500
Time: 685.204825 ms

srun -N 1 --gres=gpu:1 ./benchmark 10000
Time: 1615.857813 ms

// If out of the loop

srun -N 1 --gres=gpu:1 ./benchmark 100
Time: 0.064541 ms

srun -N 1 --gres=gpu:1 ./benchmark 1000
Time: 2.380874 ms

srun -N 1 --gres=gpu:1 ./benchmark 2500
Time: 29.607309 ms

srun -N 1 --gres=gpu:1 ./benchmark 5000
Time: 205.759017 ms

srun -N 1 --gres=gpu:1 ./benchmark 7500
Time: 685.005835 ms

srun -N 1 --gres=gpu:1 ./benchmark 10000
Time: 1615.768110 ms

// Reduce shared memory usage

srun -N 1 --gres=gpu:1 ./benchmark 100
Time: 0.063991 ms

srun -N 1 --gres=gpu:1 ./benchmark 1000
Time: 2.225953 ms

srun -N 1 --gres=gpu:1 ./benchmark 2500
Time: 27.292980 ms

srun -N 1 --gres=gpu:1 ./benchmark 5000
Time: 189.095267 ms

srun -N 1 --gres=gpu:1 ./benchmark 7500
Time: 629.174452 ms

srun -N 1 --gres=gpu:1 ./benchmark 10000
Time: 1483.424780 ms

// Extract common operations

srun -N 1 --gres=gpu:1 ./benchmark 100
Time: 0.061384 ms

srun -N 1 --gres=gpu:1 ./benchmark 1000
Time: 2.116541 ms

srun -N 1 --gres=gpu:1 ./benchmark 2500
Time: 25.755558 ms

srun -N 1 --gres=gpu:1 ./benchmark 5000
Time: 179.221568 ms

srun -N 1 --gres=gpu:1 ./benchmark 7500
Time: 593.207844 ms

srun -N 1 --gres=gpu:1 ./benchmark 10000
Time: 1397.727512 ms

// Use constant BLOCK_SIZE instead of blockDim.x

srun -N 1 --gres=gpu:1 ./benchmark 100
Time: 0.051181 ms

srun -N 1 --gres=gpu:1 ./benchmark 1000
Time: 1.778913 ms

srun -N 1 --gres=gpu:1 ./benchmark 2500
Time: 19.347277 ms

srun -N 1 --gres=gpu:1 ./benchmark 5000
Time: 150.525667 ms

srun -N 1 --gres=gpu:1 ./benchmark 7500
Time: 490.784953 ms

srun -N 1 --gres=gpu:1 ./benchmark 10000
Time: 1155.117260 ms

// Move if in stage 2 outside

srun -N 1 --gres=gpu:1 ./benchmark 100
Time: 0.056458 ms

srun -N 1 --gres=gpu:1 ./benchmark 1000
Time: 1.582459 ms

srun -N 1 --gres=gpu:1 ./benchmark 2500
Time: 21.280381 ms

srun -N 1 --gres=gpu:1 ./benchmark 5000
Time: 149.748861 ms

srun -N 1 --gres=gpu:1 ./benchmark 7500
Time: 490.719905 ms

srun -N 1 --gres=gpu:1 ./benchmark 10000
Time: 1154.779458 ms

// 1 * 1 Batch

srun -N 1 --gres=gpu:1 ./benchmark 100
Time: 0.051026 ms

srun -N 1 --gres=gpu:1 ./benchmark 1000
Time: 1.581217 ms

srun -N 1 --gres=gpu:1 ./benchmark 2500
Time: 19.307184 ms

srun -N 1 --gres=gpu:1 ./benchmark 5000
Time: 146.864276 ms

srun -N 1 --gres=gpu:1 ./benchmark 7500
Time: 1154.174578 ms

srun -N 1 --gres=gpu:1 ./benchmark 10000
Time: 1180.886921 ms

// 2 * 2 Batch

srun -N 1 --gres=gpu:1 ./benchmark 100
Time: 0.071251 ms

srun -N 1 --gres=gpu:1 ./benchmark 1000
Time: 1.566494 ms

srun -N 1 --gres=gpu:1 ./benchmark 2500
Time: 22.354504 ms

srun -N 1 --gres=gpu:1 ./benchmark 5000
Time: 161.878541 ms

srun -N 1 --gres=gpu:1 ./benchmark 7500
Time: 542.113646 ms

srun -N 1 --gres=gpu:1 ./benchmark 10000
Time: 1180.886921 ms

// 4 * 4 Batch

srun -N 1 --gres=gpu:1 ./benchmark 100
Time: 0.097997 ms

srun -N 1 --gres=gpu:1 ./benchmark 1000
Time: 1.603058 ms

srun -N 1 --gres=gpu:1 ./benchmark 2500
Time: 14.833889 ms

srun -N 1 --gres=gpu:1 ./benchmark 5000
Time: 112.775904 ms

srun -N 1 --gres=gpu:1 ./benchmark 7500
Time: 373.727811 ms

srun -N 1 --gres=gpu:1 ./benchmark 10000
Time: 873.888316 ms

// 6 * 6 Batch

srun -N 1 --gres=gpu:1 ./benchmark 100
Time: 0.123338 ms

srun -N 1 --gres=gpu:1 ./benchmark 1000
Time: 2.013014 ms

srun -N 1 --gres=gpu:1 ./benchmark 2500
Time: 17.853758 ms

srun -N 1 --gres=gpu:1 ./benchmark 5000
Time: 108.956864 ms

srun -N 1 --gres=gpu:1 ./benchmark 7500
Time: 348.857678 ms

srun -N 1 --gres=gpu:1 ./benchmark 10000
Time: 816.500413 ms

// Combine

srun -N 1 --gres=gpu:1 ./benchmark 100
Time: 0.056182 ms

srun -N 1 --gres=gpu:1 ./benchmark 1000
Time: 1.560141 ms

srun -N 1 --gres=gpu:1 ./benchmark 2500
Time: 16.246730 ms

srun -N 1 --gres=gpu:1 ./benchmark 5000
Time: 108.173029 ms

srun -N 1 --gres=gpu:1 ./benchmark 7500
Time: 346.847511 ms

srun -N 1 --gres=gpu:1 ./benchmark 10000
Time: 814.232973 ms